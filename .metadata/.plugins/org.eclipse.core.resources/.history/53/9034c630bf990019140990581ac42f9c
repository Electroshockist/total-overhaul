package electrodead.total_overhaul;

import java.util.Random;

import net.minecraft.block.BeetrootBlock;
import net.minecraft.block.BlockCrops;
import net.minecraft.block.BlockState;
import net.minecraft.block.CropsBlock;
import net.minecraft.block.state.IBlockState;
import net.minecraft.entity.item.EntityXPOrb;
import net.minecraft.entity.item.ExperienceOrbEntity;
import net.minecraft.world.IWorld;
import net.minecraft.world.World;
import net.minecraftforge.event.world.BlockEvent.BreakEvent;

public class CropModifications {

	private static Random random = new Random();

	public static void onBreakEvent(BreakEvent event) {
		
		System.out.println(event.getState().getBlock().getTranslationKey());
		IBlockState eventState = event.getState();

		if (event.getState().getBlock() instanceof BlockCrops) {

			if (eventState.getBlock() instanceof BeetrootBlock) {
				BeetrootBlock tempBR = (BeetrootBlock) event.getState().getBlock();

				if (((Integer) eventState.get(tempBR.BEETROOT_AGE)).intValue() == tempBR.getMaxAge()) {
					summonXP(event);
				}

			} else {
				BlockCrops tempBC = (BlockCrops) event.getState().getBlock();

				if (((Integer) eventState.get(tempBC.AGE)).intValue() == tempBC.getMaxAge()) {
					summonXP(event);
				}
			}
		}
	}

	private static void summonXP(BreakEvent event) {
		IWorld world = event.getWorld();

		int XPChance = random.nextInt(3);

		int XPValue = 1;// random.nextInt(2);

		System.out.println(XPValue);

		if (XPChance != 0) {
			world.addEntity(new EntityXPOrb((World) world, event.getPos().getX(), event.getPos().getY(),
					event.getPos().getZ(), XPValue));
		}
	}

}
